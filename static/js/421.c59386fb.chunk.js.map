{"version":3,"file":"static/js/421.c59386fb.chunk.js","mappings":"oOAUMA,EAAS,SAAAC,IAAAC,EAAAA,EAAAA,GAAAF,EAAAC,GAAA,IAAAE,GAAAC,EAAAA,EAAAA,GAAAJ,GAEd,SAAAA,EAAaK,GAAU,OAAAC,EAAAA,EAAAA,GAAA,KAAAN,GAAAG,EAAAI,KAAA,KAEfF,EAER,CA8GC,OA9GAG,EAAAA,EAAAA,GAAAR,EAAA,EAAAS,IAAA,OAAAC,MAED,SAAMC,EAAKC,EAAQC,EAAYC,GAE9B,IAAMC,EAAQC,KAERC,EAAS,IAAIC,EAAAA,IAAYH,EAAMV,SACrCY,EAAOE,QAASJ,EAAMK,MACtBH,EAAOI,gBAAiB,eACxBJ,EAAOK,iBAAkBP,EAAMQ,eAC/BN,EAAOO,mBAAoBT,EAAMU,iBACjCR,EAAOS,KAAMf,GAAK,SAAWgB,GAE5B,IAECf,EAAQG,EAAMa,MAAOD,GAEtB,CAAE,MAAQE,GAEJf,EAEJA,EAASe,GAITC,QAAQC,MAAOF,GAIhBd,EAAMV,QAAQ2B,UAAWrB,EAE1B,CAED,GAAGE,EAAYC,EAEhB,GAAC,CAAAL,IAAA,QAAAC,MAED,SAAOuB,GAgBN,IAAM5B,EAAU,IAAI6B,EAAAA,IACpB7B,EAAQ8B,gBAAgB,SAAWxB,GAElC,IAAMyB,EAjBP,SAAmBzB,GAElB,IAAM,IAAMS,KAAQiB,EAEnB,GAAKjB,EAAKkB,OAAS3B,EAAI4B,UAAa5B,EAEnC,OAAO0B,EAAKjB,EAMf,CAKeoB,CAAU7B,GAExB,GAAKyB,EAAQ,CAEZN,QAAQW,IAAK,UAAW9B,GAExB,IAAM+B,EAAO,IAAIC,KAAM,CAAEP,EAAMQ,QAAU,CAAEC,KAAM,6BACjD,OAAOC,IAAIC,gBAAiBL,EAE7B,CAEA,OAAO/B,CAER,IAIA,IAAM0B,EAAMW,EAAAA,GAAkB,IAAIC,WAAYhB,IAE9C,GAAKI,EAAK,WAAc,CAEvB,IAEMa,GAFM,IAAIC,WAAYC,gBAAiBJ,EAAAA,GAAkBX,EAAK,YAAe,mBAEjEgB,cAAe,6BAEjC,GAAKH,EAGJ,OADe,IAAII,EAAAA,cAAejD,GACpBuB,MAAOoB,EAAAA,GAAkBX,EAAKa,EAAMK,cAIpD,MAIC,IAAM,IAAMnC,KAFZU,QAAQ0B,KAAM,oCAEMnB,EAAM,CAIzB,GAAmB,QAFDjB,EAAKqC,MAAO,KAAMC,MAAMC,cAKzC,OADe,IAAIL,EAAAA,cAAejD,GACpBuB,MAAOoB,EAAAA,GAAkBX,EAAKjB,IAI9C,CAKD,OADAU,QAAQC,MAAO,uCACR,CAAE6B,MAAO,IAAIC,EAAAA,IAErB,KAAC7D,CAAA,CApHa,CAAS8D,EAAAA,I","sources":["ezyvuecore/three/examples/jsm/loaders/KMZLoader.js"],"sourcesContent":["import {\r\n\tFileLoader,\r\n\tGroup,\r\n\tLoader,\r\n\tLoadingManager\r\n} from '../../../build/three';\r\n\r\nimport { ColladaLoader } from '../loaders/ColladaLoader.js';\r\nimport * as fflate from '../libs/fflate.module.js';\r\n\r\nclass KMZLoader extends Loader {\r\n\r\n\tconstructor( manager ) {\r\n\r\n\t\tsuper( manager );\r\n\r\n\t}\r\n\r\n\tload( url, onLoad, onProgress, onError ) {\r\n\r\n\t\tconst scope = this;\r\n\r\n\t\tconst loader = new FileLoader( scope.manager );\r\n\t\tloader.setPath( scope.path );\r\n\t\tloader.setResponseType( 'arraybuffer' );\r\n\t\tloader.setRequestHeader( scope.requestHeader );\r\n\t\tloader.setWithCredentials( scope.withCredentials );\r\n\t\tloader.load( url, function ( text ) {\r\n\r\n\t\t\ttry {\r\n\r\n\t\t\t\tonLoad( scope.parse( text ) );\r\n\r\n\t\t\t} catch ( e ) {\r\n\r\n\t\t\t\tif ( onError ) {\r\n\r\n\t\t\t\t\tonError( e );\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tconsole.error( e );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tscope.manager.itemError( url );\r\n\r\n\t\t\t}\r\n\r\n\t\t}, onProgress, onError );\r\n\r\n\t}\r\n\r\n\tparse( data ) {\r\n\r\n\t\tfunction findFile( url ) {\r\n\r\n\t\t\tfor ( const path in zip ) {\r\n\r\n\t\t\t\tif ( path.slice( - url.length ) === url ) {\r\n\r\n\t\t\t\t\treturn zip[ path ];\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tconst manager = new LoadingManager();\r\n\t\tmanager.setURLModifier( function ( url ) {\r\n\r\n\t\t\tconst image = findFile( url );\r\n\r\n\t\t\tif ( image ) {\r\n\r\n\t\t\t\tconsole.log( 'Loading', url );\r\n\r\n\t\t\t\tconst blob = new Blob( [ image.buffer ], { type: 'application/octet-stream' } );\r\n\t\t\t\treturn URL.createObjectURL( blob );\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn url;\r\n\r\n\t\t} );\r\n\r\n\t\t//\r\n\r\n\t\tconst zip = fflate.unzipSync( new Uint8Array( data ) );\r\n\r\n\t\tif ( zip[ 'doc.kml' ] ) {\r\n\r\n\t\t\tconst xml = new DOMParser().parseFromString( fflate.strFromU8( zip[ 'doc.kml' ] ), 'application/xml' );\r\n\r\n\t\t\tconst model = xml.querySelector( 'Placemark Model Link href' );\r\n\r\n\t\t\tif ( model ) {\r\n\r\n\t\t\t\tconst loader = new ColladaLoader( manager );\r\n\t\t\t\treturn loader.parse( fflate.strFromU8( zip[ model.textContent ] ) );\r\n\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconsole.warn( 'KMZLoader: Missing doc.kml file.' );\r\n\r\n\t\t\tfor ( const path in zip ) {\r\n\r\n\t\t\t\tconst extension = path.split( '.' ).pop().toLowerCase();\r\n\r\n\t\t\t\tif ( extension === 'dae' ) {\r\n\r\n\t\t\t\t\tconst loader = new ColladaLoader( manager );\r\n\t\t\t\t\treturn loader.parse( fflate.strFromU8( zip[ path ] ) );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tconsole.error( 'KMZLoader: Couldn\\'t find .dae file.' );\r\n\t\treturn { scene: new Group() };\r\n\r\n\t}\r\n\r\n}\r\n\r\nexport { KMZLoader };\r\n"],"names":["KMZLoader","_Loader","_inherits","_super","_createSuper","manager","_classCallCheck","call","_createClass","key","value","url","onLoad","onProgress","onError","scope","this","loader","FileLoader","setPath","path","setResponseType","setRequestHeader","requestHeader","setWithCredentials","withCredentials","load","text","parse","e","console","error","itemError","data","LoadingManager","setURLModifier","image","zip","slice","length","findFile","log","blob","Blob","buffer","type","URL","createObjectURL","fflate","Uint8Array","model","DOMParser","parseFromString","querySelector","ColladaLoader","textContent","warn","split","pop","toLowerCase","scene","Group","Loader"],"sourceRoot":""}