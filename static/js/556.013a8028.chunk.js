"use strict";(self.webpackChunkezyvuefree=self.webpackChunkezyvuefree||[]).push([[556],{556:function(e,t,r){r.r(t),r.d(t,{ThreeMFLoader:function(){return l}});var a=r(5671),n=r(3144),i=r(136),o=r(9388),u=r(804),s=r(6618),l=function(e){(0,i.Z)(r,e);var t=(0,o.Z)(r);function r(e){var n;return(0,a.Z)(this,r),(n=t.call(this,e)).availableExtensions=[],n}return(0,n.Z)(r,[{key:"load",value:function(e,t,r,a){var n=this,i=new u.hH6(n.manager);i.setPath(n.path),i.setResponseType("arraybuffer"),i.setRequestHeader(n.requestHeader),i.setWithCredentials(n.withCredentials),i.load(e,(function(r){try{t(n.parse(r))}catch(i){a?a(i):console.error(i),n.manager.itemError(e)}}),r,a)}},{key:"parse",value:function(e){var t=this,r=new u.dpR(this.manager);function a(e){for(var t=[],r=(new DOMParser).parseFromString(e,"application/xml").querySelectorAll("Relationship"),a=0;a<r.length;a++){var n=r[a],i={target:n.getAttribute("Target"),id:n.getAttribute("Id"),type:n.getAttribute("Type")};t.push(i)}return t}function n(e){for(var t={id:e.getAttribute("id"),basematerials:[]},r=e.querySelectorAll("base"),a=0;a<r.length;a++){var n=p(r[a]);n.index=a,t.basematerials.push(n)}return t}function i(e){for(var t={id:e.getAttribute("id"),texid:e.getAttribute("texid"),displaypropertiesid:e.getAttribute("displaypropertiesid")},r=e.querySelectorAll("tex2coord"),a=[],n=0;n<r.length;n++){var i=r[n],o=i.getAttribute("u"),u=i.getAttribute("v");a.push(parseFloat(o),parseFloat(u))}return t.uvs=new Float32Array(a),t}function o(e){for(var t={id:e.getAttribute("id"),displaypropertiesid:e.getAttribute("displaypropertiesid")},r=e.querySelectorAll("color"),a=[],n=new u.Ilk,i=0;i<r.length;i++){var o=r[i].getAttribute("color");n.setStyle(o.substring(0,7)),n.convertSRGBToLinear(),a.push(n.r,n.g,n.b)}return t.colors=new Float32Array(a),t}function l(e){for(var t={id:e.getAttribute("id")},r=e.querySelectorAll("pbmetallic"),a=[],n=0;n<r.length;n++){var i=r[n];a.push({name:i.getAttribute("name"),metallicness:parseFloat(i.getAttribute("metallicness")),roughness:parseFloat(i.getAttribute("roughness"))})}return t.data=a,t}function p(e){var t={};return t.name=e.getAttribute("name"),t.displaycolor=e.getAttribute("displaycolor"),t.displaypropertiesid=e.getAttribute("displaypropertiesid"),t}function c(e){var t={};t.objectId=e.getAttribute("objectid");var r=e.getAttribute("transform");return r&&(t.transform=v(r)),t}function v(e){var t=[];e.split(" ").forEach((function(e){t.push(parseFloat(e))}));var r=new u.yGw;return r.set(t[0],t[3],t[6],t[9],t[1],t[4],t[7],t[10],t[2],t[5],t[8],t[11],0,0,0,1),r}function d(e){var t={type:e.getAttribute("type")},r=e.getAttribute("id");r&&(t.id=r);var a=e.getAttribute("pid");a&&(t.pid=a);var n=e.getAttribute("pindex");n&&(t.pindex=n);var i=e.getAttribute("thumbnail");i&&(t.thumbnail=i);var o=e.getAttribute("partnumber");o&&(t.partnumber=o);var u=e.getAttribute("name");u&&(t.name=u);var s=e.querySelector("mesh");s&&(t.mesh=function(e){for(var t={},r=[],a=e.querySelectorAll("vertices vertex"),n=0;n<a.length;n++){var i=a[n],o=i.getAttribute("x"),u=i.getAttribute("y"),s=i.getAttribute("z");r.push(parseFloat(o),parseFloat(u),parseFloat(s))}t.vertices=new Float32Array(r);for(var l=[],p=[],c=e.querySelectorAll("triangles triangle"),v=0;v<c.length;v++){var d=c[v],h=d.getAttribute("v1"),g=d.getAttribute("v2"),f=d.getAttribute("v3"),b=d.getAttribute("p1"),m=d.getAttribute("p2"),y=d.getAttribute("p3"),A=d.getAttribute("pid"),w={};w.v1=parseInt(h,10),w.v2=parseInt(g,10),w.v3=parseInt(f,10),p.push(w.v1,w.v2,w.v3),b&&(w.p1=parseInt(b,10)),m&&(w.p2=parseInt(m,10)),y&&(w.p3=parseInt(y,10)),A&&(w.pid=A),0<Object.keys(w).length&&l.push(w)}return t.triangleProperties=l,t.triangles=new Uint32Array(p),t}(s));var l=e.querySelector("components");return l&&(t.components=function(e){for(var t=[],r=e.querySelectorAll("component"),a=0;a<r.length;a++){var n=c(r[a]);t.push(n)}return t}(l)),t}function h(e){var t={unit:e.getAttribute("unit")||"millimeter"},r=e.querySelectorAll("metadata");r&&(t.metadata=function(e){for(var t={},r=0;r<e.length;r++){var a=e[r],n=a.getAttribute("name");0<=["Title","Designer","Description","Copyright","LicenseTerms","Rating","CreationDate","ModificationDate"].indexOf(n)&&(t[n]=a.textContent)}return t}(r));var a=e.querySelector("resources");a&&(t.resources=function(e){for(var t={basematerials:{}},r=e.querySelectorAll("basematerials"),a=0;a<r.length;a++){var u=n(r[a]);t.basematerials[u.id]=u}t.texture2d={};for(var s,p=e.querySelectorAll("texture2d"),c=0;c<p.length;c++){var v={id:(s=p[c]).getAttribute("id"),path:s.getAttribute("path"),contenttype:s.getAttribute("contenttype"),tilestyleu:s.getAttribute("tilestyleu"),tilestylev:s.getAttribute("tilestylev"),filter:s.getAttribute("filter")};t.texture2d[v.id]=v}t.colorgroup={};for(var h=e.querySelectorAll("colorgroup"),g=0;g<h.length;g++){var f=o(h[g]);t.colorgroup[f.id]=f}t.pbmetallicdisplayproperties={};for(var b=e.querySelectorAll("pbmetallicdisplayproperties"),m=0;m<b.length;m++){var y=l(b[m]);t.pbmetallicdisplayproperties[y.id]=y}t.texture2dgroup={};for(var A=e.querySelectorAll("texture2dgroup"),w=0;w<A.length;w++){var x=i(A[w]);t.texture2dgroup[x.id]=x}t.object={};for(var S=e.querySelectorAll("object"),k=0;k<S.length;k++){var j=d(S[k]);t.object[j.id]=j}return t}(a));var u=e.querySelector("build");return u&&(t.build=function(e){for(var t=[],r=e.querySelectorAll("item"),a=0;a<r.length;a++){var n=r[a],i={objectId:n.getAttribute("objectid")},o=n.getAttribute("transform");o&&(i.transform=v(o)),t.push(i)}return t}(u)),t}function g(e,t,a,n){var i=e.texid,o=a.resources.texture2d[i];if(o){var s=n[o.path],l=o.contenttype,p=new Blob([s],{type:l}),c=URL.createObjectURL(p),v=r.load(c,(function(){URL.revokeObjectURL(c)}));switch(v.encoding=u.knz,o.tilestyleu){case"wrap":default:v.wrapS=u.rpg;break;case"mirror":v.wrapS=u.OoA;break;case"none":case"clamp":v.wrapS=u.uWy}switch(o.tilestylev){case"wrap":default:v.wrapT=u.rpg;break;case"mirror":v.wrapT=u.OoA;break;case"none":case"clamp":v.wrapT=u.uWy}switch(o.filter){case"auto":default:v.magFilter=u.wem,v.minFilter=u.D1R;break;case"linear":v.magFilter=u.wem,v.minFilter=u.wem;break;case"nearest":v.magFilter=u.TyD,v.minFilter=u.TyD}return v}return null}function f(e,t,r,a,n,i,o){for(var s=o.pindex,l={},p=0,c=t.length;p<c;p++){var v=t[p],d=void 0!==v.p1?v.p1:s;void 0===l[d]&&(l[d]=[]),l[d].push(v)}for(var h=Object.keys(l),g=[],f=0,b=h.length;f<b;f++){for(var m=h[f],y=l[m],A=x(e.basematerials[m],a,n,i,o,S),w=new u.u9r,k=[],j=r.vertices,F=0,q=y.length;F<q;F++){var R=y[F];k.push(j[3*R.v1+0]),k.push(j[3*R.v1+1]),k.push(j[3*R.v1+2]),k.push(j[3*R.v2+0]),k.push(j[3*R.v2+1]),k.push(j[3*R.v2+2]),k.push(j[3*R.v3+0]),k.push(j[3*R.v3+1]),k.push(j[3*R.v3+2])}w.setAttribute("position",new u.a$l(k,3));var T=new u.Kj0(w,A);g.push(T)}return g}function b(e,t,r,a,n,i,o){for(var s=new u.u9r,l=[],p=[],c=r.vertices,v=e.uvs,d=0,h=t.length;d<h;d++){var f=t[d];l.push(c[3*f.v1+0]),l.push(c[3*f.v1+1]),l.push(c[3*f.v1+2]),l.push(c[3*f.v2+0]),l.push(c[3*f.v2+1]),l.push(c[3*f.v2+2]),l.push(c[3*f.v3+0]),l.push(c[3*f.v3+1]),l.push(c[3*f.v3+2]),p.push(v[2*f.p1+0]),p.push(v[2*f.p1+1]),p.push(v[2*f.p2+0]),p.push(v[2*f.p2+1]),p.push(v[2*f.p3+0]),p.push(v[2*f.p3+1])}s.setAttribute("position",new u.a$l(l,3)),s.setAttribute("uv",new u.a$l(p,2));var b=x(e,a,n,i,o,g),m=new u.xoR({map:b,flatShading:!0});return new u.Kj0(s,m)}function m(e,t,r,a){for(var n=new u.u9r,i=[],o=[],s=r.vertices,l=e.colors,p=0,c=t.length;p<c;p++){var v=t[p],d=v.v1,h=v.v2,g=v.v3;i.push(s[3*d+0]),i.push(s[3*d+1]),i.push(s[3*d+2]),i.push(s[3*h+0]),i.push(s[3*h+1]),i.push(s[3*h+2]),i.push(s[3*g+0]),i.push(s[3*g+1]),i.push(s[3*g+2]);var f=void 0!==v.p1?v.p1:a.pindex,b=void 0!==v.p2?v.p2:f,m=void 0!==v.p3?v.p3:f;o.push(l[3*f+0]),o.push(l[3*f+1]),o.push(l[3*f+2]),o.push(l[3*b+0]),o.push(l[3*b+1]),o.push(l[3*b+2]),o.push(l[3*m+0]),o.push(l[3*m+1]),o.push(l[3*m+2])}n.setAttribute("position",new u.a$l(i,3)),n.setAttribute("color",new u.a$l(o,3));var y=new u.xoR({vertexColors:!0,flatShading:!0});return new u.Kj0(n,y)}function y(e){var t=new u.u9r;t.setIndex(new u.TlE(e.triangles,1)),t.setAttribute("position",new u.TlE(e.vertices,3));var r=new u.xoR({color:16777215,flatShading:!0});return new u.Kj0(t,r)}function A(e,t){return void 0!==t.resources.texture2dgroup[e]?"texture":void 0!==t.resources.basematerials[e]?"material":void 0!==t.resources.colorgroup[e]?"vertexColors":"default"===e?"default":void 0}function w(e,t,r,a,n){for(var i=new u.ZAu,o=function(e,t){for(var r={},a=e.triangleProperties,n=t.pid,i=0,o=a.length;i<o;i++){var u=a[i],s=void 0!==u.pid?u.pid:n;void 0===s&&(s="default"),void 0===r[s]&&(r[s]=[]),r[s].push(u)}return r}(e,n),s=function(e,t,r,a,n,i){for(var o=Object.keys(e),u=[],s=0,l=o.length;s<l;s++){var p=o[s],c=e[p];switch(A(p,a)){case"material":for(var v=f(a.resources.basematerials[p],c,t,r,a,n,i),d=0,h=v.length;d<h;d++)u.push(v[d]);break;case"texture":var g=a.resources.texture2dgroup[p];u.push(b(g,c,t,r,a,n,i));break;case"vertexColors":var w=a.resources.colorgroup[p];u.push(m(w,c,t,i));break;case"default":u.push(y(t));break;default:console.error("THREE.3MFLoader: Unsupported resource type.")}}if(i.name)for(var x=0;x<u.length;x++)u[x].name=i.name;return u}(o,e,t,r,a,n),l=0,p=s.length;l<p;l++)i.add(s[l]);return i}function x(e,t,r,a,n,i){return void 0!==e.build||(e.build=i(e,t,r,a,n)),e.build}function S(e,t,r){var a,n=e.displaypropertiesid,i=r.resources.pbmetallicdisplayproperties;if(null!==n&&void 0!==i[n]){var o=i[n].data[e.index];a=new u.Wid({flatShading:!0,roughness:o.roughness,metalness:o.metallicness})}else a=new u.xoR({flatShading:!0});a.name=e.name;var s=e.displaycolor,l=s.substring(0,7);return a.color.setStyle(l),a.color.convertSRGBToLinear(),9===s.length&&(a.opacity=parseInt(s.charAt(7)+s.charAt(8),16)/255),a}function k(e,t,r,a){for(var n=new u.ZAu,i=0;i<e.length;i++){var o=e[i],s=t[o.objectId];void 0===s&&(j(o.objectId,t,r,a),s=t[o.objectId]);var l=s.clone(),p=o.transform;p&&l.applyMatrix4(p),n.add(l)}return n}function j(e,r,a,n){var i=a.resources.object[e];if(i.mesh){var o=i.mesh;!function(e,r,a){if(e){for(var n=[],i=Object.keys(e),o=0;o<i.length;o++)for(var u=i[o],s=0;s<t.availableExtensions.length;s++){var l=t.availableExtensions[s];l.ns===u&&n.push(l)}for(var p=0;p<n.length;p++){var c=n[p];c.apply(a,e[c.ns],r)}}}(a.extensions,o,a.xml),r[i.id]=x(o,r,a,n,i,w)}else{var u=i.components;r[i.id]=x(u,r,a,n,i,k)}i.name&&(r[i.id].name=i.name)}var F=function(e){var t,r,n,i=null,o=null,u=[],l=[],p={},c={},v=new TextDecoder;try{i=s.GZ(new Uint8Array(e))}catch(T){if(T instanceof ReferenceError)return console.error("THREE.3MFLoader: fflate missing and file is compressed."),null}for(o in i)o.match(/\_rels\/.rels$/)?t=o:o.match(/3D\/_rels\/.*\.model\.rels$/)?r=o:o.match(/^3D\/.*\.model$/)?u.push(o):o.match(/^3D\/Textures?\/.*/)&&l.push(o);var d=i[t],g=a(v.decode(d));if(r){var f=i[r];n=a(v.decode(f))}for(var b=0;b<u.length;b++){var m=u[b],y=i[m],A=v.decode(y),w=(new DOMParser).parseFromString(A,"application/xml");"model"!==w.documentElement.nodeName.toLowerCase()&&console.error("THREE.3MFLoader: Error loading 3MF - no 3MF document found: ",m);for(var x=w.querySelector("model"),S={},k=0;k<x.attributes.length;k++){var j=x.attributes[k];j.name.match(/^xmlns:(.+)$/)&&(S[j.value]=RegExp.$1)}var F=h(x);F.xml=x,0<Object.keys(S).length&&(F.extensions=S),p[m]=F}for(var q=0;q<l.length;q++){var R=l[q];c[R]=i[R].buffer}return{rels:g,modelRels:n,model:p,printTicket:{},texture:c}}(e),q=function(e){var t=e.model,r=e.modelRels,a={},n=Object.keys(t),i={};if(r)for(var o=0,u=r.length;o<u;o++){var s=r[o],l=s.target.substring(1);e.texture[l]&&(i[s.target]=e.texture[l])}for(var p=0;p<n.length;p++)for(var c=t[n[p]],v=Object.keys(c.resources.object),d=0;d<v.length;d++){j(v[d],a,c,i)}return a}(F);return function(e,t){for(var r=new u.ZAu,a=function(e){for(var t=0;t<e.length;t++){var r=e[t];if("model"===r.target.split(".").pop().toLowerCase())return r}}(t.rels),n=t.model[a.target.substring(1)].build,i=0;i<n.length;i++){var o=n[i],s=e[o.objectId].clone(),l=o.transform;l&&s.applyMatrix4(l),r.add(s)}return r}(q,F)}},{key:"addExtension",value:function(e){this.availableExtensions.push(e)}}]),r}(u.aNw)}}]);
//# sourceMappingURL=556.013a8028.chunk.js.map